<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Auth Demo ‚Äî Login & Sign Up</title>
  <!-- Tailwind CSS (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gray-50 text-gray-900">
  <div class="max-w-md mx-auto p-6">
    <div class="text-center mb-6">
      <h1 class="text-2xl font-bold">üîê Login & Sign Up</h1>
      <p class="text-sm text-gray-600">Email/Password auth with Firebase</p>
    </div>

    <!-- Tabs -->
    <div class="flex mb-4 rounded-xl bg-white shadow">
      <button id="tab-login" class="w-1/2 py-2 font-medium rounded-l-xl bg-gray-100">Log In</button>
      <button id="tab-signup" class="w-1/2 py-2 font-medium rounded-r-xl">Sign Up</button>
    </div>

    <!-- Login Card -->
    <div id="card-login" class="rounded-2xl bg-white shadow p-5">
      <form id="login-form" class="space-y-4">
        <div>
          <label class="block text-sm mb-1">Email</label>
          <input id="login-email" type="email" required
                 class="w-full rounded-xl border px-3 py-2 focus:outline-none focus:ring">
        </div>
        <div>
          <label class="block text-sm mb-1">Password</label>
          <div class="relative">
            <input id="login-password" type="password" required
                   class="w-full rounded-xl border px-3 py-2 pr-10 focus:outline-none focus:ring">
            <button type="button" data-toggle="login-password"
                    class="toggle-pass absolute right-2 top-2 text-xs text-gray-600">Show</button>
          </div>
        </div>
        <button class="w-full rounded-xl bg-blue-600 text-white py-2 font-semibold hover:bg-blue-700">Log In</button>
      </form>
      <p id="login-msg" class="mt-3 text-sm"></p>
    </div>

    <!-- Signup Card -->
    <div id="card-signup" class="hidden rounded-2xl bg-white shadow p-5">
      <form id="signup-form" class="space-y-4">
        <div>
          <label class="block text-sm mb-1">Email</label>
          <input id="signup-email" type="email" required
                 class="w-full rounded-xl border px-3 py-2 focus:outline-none focus:ring">
        </div>
        <div>
          <label class="block text-sm mb-1">Password</label>
          <div class="relative">
            <input id="signup-password" type="password" required minlength="6"
                   class="w-full rounded-xl border px-3 py-2 pr-10 focus:outline-none focus:ring">
            <button type="button" data-toggle="signup-password"
                    class="toggle-pass absolute right-2 top-2 text-xs text-gray-600">Show</button>
          </div>
          <div class="mt-2">
            <div class="h-2 bg-gray-200 rounded-full">
              <div id="pwd-bar" class="h-2 w-0 rounded-full"></div>
            </div>
            <p id="pwd-hint" class="text-xs text-gray-600 mt-1">Use 8+ chars, mix of letters, numbers, symbols.</p>
          </div>
        </div>
        <button class="w-full rounded-xl bg-emerald-600 text-white py-2 font-semibold hover:bg-emerald-700">Sign Up</button>
      </form>
      <p id="signup-msg" class="mt-3 text-sm"></p>
    </div>

    <!-- User Panel -->
    <div id="panel-user" class="hidden mt-6 rounded-2xl bg-white shadow p-5">
      <h2 class="text-lg font-semibold mb-1">Welcome, <span id="u-email" class="font-mono"></span></h2>
      <p id="verify-msg" class="text-sm text-amber-700 bg-amber-50 border border-amber-200 rounded-lg px-3 py-2 mt-2 hidden">
        Your email is not verified. <button id="btn-send-verify" class="underline">Send verification email</button>
      </p>
      <div class="mt-4 flex gap-2">
        <button id="btn-logout" class="rounded-xl bg-gray-800 text-white px-4 py-2 hover:bg-black">Log Out</button>
      </div>
    </div>

    <footer class="mt-10 text-center text-xs text-gray-500">
      ¬© 2025 Demo. Educational use only.
    </footer>
  </div>

  <!-- Firebase SDKs (v10+) -->
  <script type="module">
    // 1) Replace with your Firebase config (Project settings ‚Üí General ‚Üí SDK setup and config)
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      appId: "YOUR_APP_ID",
    };

    // 2) Firebase imports (modular CDN)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import {
      getAuth, onAuthStateChanged, signInWithEmailAndPassword,
      createUserWithEmailAndPassword, signOut, sendEmailVerification
    } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";

    // Init
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // UI Elements
    const tabLogin = document.getElementById('tab-login');
    const tabSignup = document.getElementById('tab-signup');
    const cardLogin = document.getElementById('card-login');
    const cardSignup = document.getElementById('card-signup');
    const loginForm = document.getElementById('login-form');
    const signupForm = document.getElementById('signup-form');
    const loginMsg = document.getElementById('login-msg');
    const signupMsg = document.getElementById('signup-msg');
    const pwdBar = document.getElementById('pwd-bar');
    const pwdHint = document.getElementById('pwd-hint');
    const panelUser = document.getElementById('panel-user');
    const uEmail = document.getElementById('u-email');
    const verifyMsg = document.getElementById('verify-msg');
    const btnSendVerify = document.getElementById('btn-send-verify');
    const btnLogout = document.getElementById('btn-logout');

    // Tab switching
    function setTab(which) {
      if (which === 'login') {
        tabLogin.classList.add('bg-gray-100');
        tabSignup.classList.remove('bg-gray-100');
        cardLogin.classList.remove('hidden');
        cardSignup.classList.add('hidden');
      } else {
        tabSignup.classList.add('bg-gray-100');
        tabLogin.classList.remove('bg-gray-100');
        cardSignup.classList.remove('hidden');
        cardLogin.classList.add('hidden');
      }
    }
    tabLogin.addEventListener('click', () => setTab('login'));
    tabSignup.addEventListener('click', () => setTab('signup'));

    // Show/hide password
    document.querySelectorAll('.toggle-pass').forEach(btn => {
      btn.addEventListener('click', () => {
        const id = btn.getAttribute('data-toggle');
        const input = document.getElementById(id);
        const isPwd = input.getAttribute('type') === 'password';
        input.setAttribute('type', isPwd ? 'text' : 'password');
        btn.textContent = isPwd ? 'Hide' : 'Show';
      });
    });

    // Password strength meter
    const signupPassword = document.getElementById('signup-password');
    function scorePassword(p) {
      let score = 0;
      if (!p) return 0;
      const letters = {};
      for (let i = 0; i < p.length; i++) {
        letters[p[i]] = (letters[p[i]] || 0) + 1;
        score += 5.0 / letters[p[i]];
      }
      const variations = {
        digits: /\d/.test(p),
        lower: /[a-z]/.test(p),
        upper: /[A-Z]/.test(p),
        nonWords: /\W/.test(p),
      };
      let variationCount = 0;
      for (const check in variations) variationCount += variations[check] ? 1 : 0;
      score += (variationCount - 1) * 10;
      return Math.min(100, Math.floor(score));
    }
    function renderPwdBar(score) {
      pwdBar.style.width = `${score}%`;
      let color = 'bg-red-500';
      if (score >= 75) color = 'bg-emerald-500';
      else if (score >= 50) color = 'bg-yellow-500';
      pwdBar.className = `h-2 rounded-full ${color}`;
    }
    signupPassword.addEventListener('input', () => {
      renderPwdBar(scorePassword(signupPassword.value));
    });

    // Helpers
    function showMsg(el, text, ok=false) {
      el.textContent = text;
      el.className = `mt-3 text-sm ${ok ? 'text-emerald-700' : 'text-rose-700'}`;
    }

    // Sign up
    signupForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      signupMsg.textContent = '';
      const email = document.getElementById('signup-email').value.trim();
      const password = document.getElementById('signup-password').value;

      try {
        await createUserWithEmailAndPassword(auth, email, password);
        showMsg(signupMsg, 'Account created! You can log in now.', true);
        setTab('login');
      } catch (err) {
        showMsg(signupMsg, err.message);
      }
    });

    // Log in
    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      loginMsg.textContent = '';
      const email = document.getElementById('login-email').value.trim();
      const password = document.getElementById('login-password').value;

      try {
        await signInWithEmailAndPassword(auth, email, password);
        showMsg(loginMsg, 'Logged in successfully.', true);
      } catch (err) {
        showMsg(loginMsg, err.message);
      }
    });

    // Auth state
    onAuthStateChanged(auth, (user) => {
      if (user) {
        uEmail.textContent = user.email || '';
        panelUser.classList.remove('hidden');
        verifyMsg.classList.toggle('hidden', !!user.emailVerified);
      } else {
        panelUser.classList.add('hidden');
      }
    });

    // Email verification
    btnSendVerify.addEventListener('click', async () => {
      if (auth.currentUser) {
        try {
          await sendEmailVerification(auth.currentUser);
          verifyMsg.innerHTML = 'Verification sent. Please check your inbox.';
        } catch (e) {
          verifyMsg.innerHTML = 'Error sending verification: ' + e.message;
        }
      }
    });

    // Logout
    btnLogout.addEventListener('click', async () => {
      await signOut(auth);
    });

    // Default to Login tab
    setTab('login');
  </script>
</body>
</html>